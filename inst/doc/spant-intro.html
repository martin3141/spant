<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-04-26" />

<title>Introduction to spant</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to spant</h1>
<h4 class="date"><em>2017-04-26</em></h4>



<div id="reading-raw-data-and-plotting" class="section level2">
<h2>Reading raw data and plotting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(spant)
fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;philips_spar_sdat_WS.SDAT&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spant&quot;</span>)

<span class="co"># import raw data</span>
mrs_data &lt;-<span class="st"> </span><span class="kw">read_mrs</span>(fname, <span class="dt">format =</span> <span class="st">&quot;spar_sdat&quot;</span>)

<span class="co"># output basic data structure</span>
<span class="kw">print</span>(mrs_data)</code></pre></div>
<pre><code>## MRS data parameters
## -------------------------------
## Trans. freq (MHz)       : 127.786142
## FID data points         : 1024
## X,Y,Z dimensions        : 1x1x1
## Dynamics                : 1
## Coils                   : 1
## Voxel resolution (mm)   : NAxNAxNA
## Sampling frequency (Hz) : 2000
## Contains referece data  : FALSE
## Spectral domain         : FALSE
## Reference freq. (PPM)   : 4.65</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot data in the frequency domain</span>
<span class="kw">plot</span>(mrs_data, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAGACAMAAABC/kH9AAAAWlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQtpCQ2/+2ZgC225C2///bkDrb////tmb/trb/25D//7b//9v///9uL0JRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJkElEQVR4nO3cC3vixhlA4ckmTmO3tdOQpdSX//83q7uEJC6G+fBwfM6T7GIuktCLRgKLTR+GLn31AlhsAsMTGJ7A8ASGJzA8geEJDE9geALDExiewPAEhicwPIHhCQxPYHgCw1sDTnannQuc+UVkN0pgeALDExiewPAEhicwPIHhCQxPYHh5gOUvNoHhCQxPYHgCwxMYnsDwBIYnMDyB4QkMT2B4WYBXz820IhIYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDE9geHmA/Y1/sQkMT2B4AsMTGJ7A8HIAJ8+bLTeB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDE9geALDExiewPAEhicwPIHhCQxPYHgCw8sAnI7fbF+awPAEhicwPIHhCQwvN7DShZUdWOGyEhhe/iFa4aISGN71wGl6sx9Ll5bA8ASGdzVw2rv5mwMX+NzzA5f4LG9VgU/9WuC0f/N3By7vuQucsRLfI14JnFb+Lu9J3ioe8OJ3DAKX1lXAaXFJ4NISOF9FPvlrgNPyYjp03++QwPBowGnlssBfvRDzBM4XDDit/ZCWN32bynxxXwycVn8qGTh6qcp87t8HOPxz4jKf+6XAafXHtHrjZxcpZh2FfwpBAl4YZAQOgkjR6z7Lizt/FwEfPOKa/+7hsiUSOGOXAB9+y5QBONd7jbUxJnLl53htR/R54LS2jywOeHUnErjy08qlIvo08Pry5wW+fiUtB+RY4PTNgC9/lucdiq6OIrPJrL2PCzo+31uaOwc+sPiZgQ/t8tNwcznA89faPQMf3nAWLhc+zZXX0d7oNzodncFynM8JvPcyPviOopA+A3xkyXMDDxOseVPTZBm+Bjh1r+9Uv+ba5Tl2wFlIZwMf3+1lAp4fq0835I9+9Z6BtbzHytB/ybKlbkRJx/YSRQl/+iDr6GTS4prPLcz+Rjf7cX6nQ4cD6cjSnLVUq/PtrhxvOzypkzPJ8mHsmdMIA/608Mkj40Mz3f9xeni1HFDOmUkaRov2/sPu4fwFmw8//bXdwL53NNH913fmDA7tH5Z3veK65c2rm9zJRUjnLuxyruPj2onMJtNvdeeOLP0UhpU+Tvyziza8MvZeIsPQ3i/t8N/0gYtnMJ/4OLV0atm+HvjkEdOpx65uLv0dxsOzyVUrk1hupnnG0X7Z0toaOvigsZEwTZd0XPjxWGB9gQOBTx2YzbaSK/rsRFK/1vZGulLf0KZ+Gzj0NNPqC3R49OXXLW9e3mvyultsHyeHl8DShHlyXaGdv2/u9zHDqBYNvL8nG/aJ6Ut14U33/asrOS/wfN6f2RvZ1d0Y2G6dwPAEhicwPIHhCQwvE/D42bmVVVZgfctLYHgCwxMYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDE9geALDExiewPAEhicwPIHhCQxPYHgCwxMYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDE9geALDywmsb4EJDE9geALDExiewPAEhicwPIHhCQxPYHgCwxMYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDE9geALDExiewPAEhicwPIHhCQxPYHgCwxMYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDE9geALDExheRmB9S0xgeALDExiewPAEhicwPIHhCQxPYHgCw8sFXN1B4BITGJ7A8ASGJzA8geEJDE9geALDExiewPAEhicwPIHhCQxPYHgCwxMYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDE9geALDywesb5EJDE9geALDExiewPAEhicwPIHhCQxPYHgCwxMYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8LIBe9ZsmeUDtiITGJ7A8ASGJzA8geEJDE9geGcD250mMLwrtuq8OYebzUFg+BwEhs9BYPgcBIbPQWD4HASGz0Fg+BwEhs9BYPgc/MUCPIHhCQxPYHgCwxMYnsDw5sBvT/WZAb8Fz3Xz638jJ79N6Ze/Imfw/lKtpMfIOVS9/uNnhqnMgV9/D10zbbsUCrz98fNjFyn8/lJNfRu8Gbw9/YgA3mWZ6vGqUSIS+O3psTYIXP2vD88f7esorl1KIcDb6NG5nsevf8YO0R/BwG2hg8QuPebZ1ubAmz/C9y7VXiB4H1y1jd0J122CB7sQ4LenetVvIoXfXx6jD7Lq8S36EKjexoJnELIFZ5z0gbYVbvwW/P4S/hqK3gcEArcHETE1h+nxwLF7yBtsv7HAge+Vtt1J+HEvobbIF2n9LMJ9Y4Db1RL+Xil0C77Bc9iGvz4/orbgTb1nCT3IauYSOkTXU68P5cJ6fYjffsOG6M0Nhs/ofXD0c+h2M8HvxAL3wcZJYHgCwxMYnsDwBIYnMDyB4QkMT2B4AsMTGJ7A8ASGJzA8geEJDO9+gJsvfNVngrw9HTtbY/XW4crmu3X1mRL9Nc3f25Qed/3D3l9OnQzy9s8bfH8rV3cD3J6nuvnlrxPAq/UP2TVn8swnUn+Zafz5jC/v7OLP+s3WvQB3Z8HW57NfAdycUth8b2kf+Hm6jZ+e+umNvJzuBXjbbTT/+1kR/OuhPalu236P6vXh39XI+/jaXNsCbbsvOXen33Vqk2+k9ROpbqkfl7rhvz3V7fX3/zy0Ux4uTGcxLs0ddCfA0y8Lvj3V387t/q/PYH19aL6uW8lsf/xsd6rNIPzYbLHbyYA8ft+kn0i/9Q4bbv2QyvG5Gc4nFyazCP/aRM7uBLj5zu/0cjVkt9dVW1xzmnL3x3Or1d67ORqqB/eBr94Em7NRx4nsA3fX14+vNtP9C/0sor82kbW7BG4H3XYzqtb1uM47sen6343jdlt1NN5v09UfS+DBr5r+/oXxj+niFN6dAO8P0R1w/y2nJXD/3apqV/zj74fn+ZHTphvJV4DbyTSPr12HCwIH1x/WVDvE/S34Y7riZ1vwcEPH11+/a/e9h7dggW/e/G1SZzPeNgXu13/z5Y/dOET348Du8BY82Qdv+n1wc+F5Np8bP/+Luxfg9oOO5p+36W3af6ZhM9u8hqPoSrPdeNP4MUb7z/vs+mv2gLttsj2Krh4/HDy3F/ZsPYoOqPmUcfiosv+IsT4mXgL374ObfzBr0w3Iw0RqnTlw9Y558j74oXunPbmw94fvg++3vaPwA0PxBZ+lfVkCz9v+dhLYz6LvufeX5xPA/jbJyklgeALDExiewPAEhicwPIHhCQxPYHj/Bwtd8fxW7dwaAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="basic-preprocessing" class="section level2">
<h2>Basic preprocessing</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># apply water filter and align to tNAA resonance</span>
mrs_proc &lt;-<span class="st"> </span><span class="kw">hsvd_filt</span>(mrs_data)
mrs_proc &lt;-<span class="st"> </span><span class="kw">align</span>(mrs_proc, <span class="fl">2.01</span>)
<span class="kw">plot</span>(mrs_proc, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basis-simulation" class="section level2">
<h2>Basis simulation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get the data acquistion paramters</span>
acq_paras &lt;-<span class="st"> </span><span class="kw">get_acq_paras</span>(mrs_proc)

<span class="co"># simulate a typical basis set for short TE brain analysis</span>
basis &lt;-<span class="st"> </span><span class="kw">sim_basis_1h_brain_press</span>(acq_paras)

<span class="co"># output basis info</span>
<span class="kw">print</span>(basis)</code></pre></div>
<pre><code>## Basis set parameters
## -------------------------------
## Trans. freq (MHz)       : 127.786142
## Data points             : 1024
## Sampling frequency (Hz) : 2000
## Elements                : 27
## 
## Names
## -------------------------------
## -CrCH2,Ala,Asp,Cr,GABA,Glc,Gln,
## GSH,Glu,GPC,Ins,Lac,Lip09,
## Lip13a,Lip13b,Lip20,MM09,MM12,
## MM14,MM17,MM20,NAA,NAAG,PCh,
## PCr,sIns,Tau</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot basis signals</span>
<span class="kw">stackplot</span>(basis, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="fitting" class="section level2">
<h2>Fitting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># perform VARPRO fitting to processed data</span>
fit_res &lt;-<span class="st"> </span><span class="kw">fit_mrs</span>(mrs_proc, basis)</code></pre></div>
<pre><code>## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=================================================================| 100%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the fit estimate, residual and baseline</span>
<span class="kw">plot</span>(fit_res)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
