<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-06-07" />

<title>Introduction to spant</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to spant</h1>
<h4 class="date"><em>2017-06-07</em></h4>



<div id="reading-raw-data-and-plotting" class="section level2">
<h2>Reading raw data and plotting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(spant)
fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;philips_spar_sdat_WS.SDAT&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spant&quot;</span>)

<span class="co"># import raw data</span>
mrs_data &lt;-<span class="st"> </span><span class="kw">read_mrs</span>(fname, <span class="dt">format =</span> <span class="st">&quot;spar_sdat&quot;</span>)

<span class="co"># output basic data structure</span>
<span class="kw">print</span>(mrs_data)</code></pre></div>
<pre><code>## MRS Data Parameters
## ----------------------------------
## Trans. freq (MHz)       : 127.7861
## FID data points         : 1024
## X,Y,Z dimensions        : 1x1x1
## Dynamics                : 1
## Coils                   : 1
## Voxel resolution (mm)   : 20x20x20
## Sampling frequency (Hz) : 2000
## Reference freq. (ppm)   : 4.65
## Spectral domain         : FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot data in the frequency domain</span>
<span class="kw">plot</span>(mrs_data, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basic-preprocessing" class="section level2">
<h2>Basic preprocessing</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># apply water filter and align to tNAA resonance</span>
mrs_proc &lt;-<span class="st"> </span><span class="kw">hsvd_filt</span>(mrs_data)
mrs_proc &lt;-<span class="st"> </span><span class="kw">align</span>(mrs_proc, <span class="fl">2.01</span>)
<span class="kw">plot</span>(mrs_proc, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basis-simulation" class="section level2">
<h2>Basis simulation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate a typical basis set for short TE brain analysis</span>
basis &lt;-<span class="st"> </span><span class="kw">sim_basis_1h_brain_press</span>(mrs_proc)

<span class="co"># output basis info</span>
<span class="kw">print</span>(basis)</code></pre></div>
<pre><code>## Basis set parameters
## -------------------------------
## Trans. freq (MHz)       : 127.786142
## Data points             : 1024
## Sampling frequency (Hz) : 2000
## Elements                : 27
## 
## Names
## -------------------------------
## -CrCH2,Ala,Asp,Cr,GABA,Glc,Gln,
## GSH,Glu,GPC,Ins,Lac,Lip09,
## Lip13a,Lip13b,Lip20,MM09,MM12,
## MM14,MM17,MM20,NAA,NAAG,PCh,
## PCr,sIns,Tau</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot basis signals</span>
<span class="kw">stackplot</span>(basis, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="fitting" class="section level2">
<h2>Fitting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># perform VARPRO fitting to processed data</span>
fit_res &lt;-<span class="st"> </span><span class="kw">fit_mrs</span>(mrs_proc, basis)</code></pre></div>
<pre><code>## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=================================================================| 100%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the fit estimate, residual and baseline</span>
<span class="kw">plot</span>(fit_res)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
